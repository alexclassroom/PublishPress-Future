(()=>{"use strict";var e=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,u=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){u=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(u)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};!function(n,r){var u,o=n.plugins.registerPlugin,i=n.editPost.PluginDocumentSettingPanel,s=n.components,a=s.PanelRow,c=s.DateTimePicker,f=s.CheckboxControl,l=s.SelectControl,m=s.FormTokenField,T=s.Spinner,p=n.element.Fragment,A=n.htmlEntities.decodeEntities,d=lodash,y=d.isEmpty,E=d.keys,g=d.compact,_=React.useEffect,h=n.url.addQueryArgs,b=n.data,x=b.useSelect,F=b.useDispatch,N=b.register,S=b.createReduxStore,v=b.select,I=n.apiFetch,R=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),u=1;u<t;u++)n[u-1]=arguments[u];var o;console&&r.is_debug_enabled&&(o=console).debug.apply(o,["[Future]",e].concat(n))},D=(u={futureAction:null,futureActionDate:0,futureActionEnabled:!1,futureActionTerms:[],futureActionTaxonomy:null,termsListByName:null,termsListById:null,taxonomyName:null,isFetchingTerms:!1},r&&r.defaults?(r.defaults.autoEnable&&(u.futureActionEnabled=!0),r.defaults.expireType&&(u.futureAction=r.defaults.expireType),r.default_date?u.futureActionDate=parseInt(r.default_date):u.futureActionDate=(new Date).getTime(),r.defaults.taxonomy&&(u.futureActionTaxonomy=r.defaults.taxonomy),r.defaults.terms&&(u.futureActionTerms=r.defaults.terms.split(",").map((function(e){return parseInt(e)}))),u):u);R("DEFAULT_STATE",D);var O=S("publishpress-future/store",{reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,n=arguments[1];switch(n.type){case"SET_FUTURE_ACTION":return t({},e,{futureAction:n.futureAction});case"SET_FUTURE_ACTION_DATE":return t({},e,{futureActionDate:n.futureActionDate});case"SET_FUTURE_ACTION_ENABLED":return t({},e,{futureActionEnabled:n.futureActionEnabled});case"SET_FUTURE_ACTION_TERMS":return t({},e,{futureActionTerms:n.futureActionTerms});case"SET_FUTURE_ACTION_TAXONOMY":return t({},e,{futureActionTaxonomy:n.futureActionTaxonomy});case"SET_TERMS_LIST_BY_NAME":return t({},e,{termsListByName:n.termsListByName});case"SET_TERMS_LIST_BY_ID":return t({},e,{termsListById:n.termsListById});case"SET_TAXONOMY_NAME":return t({},e,{taxonomyName:n.taxonomyName})}return e},actions:{setFutureAction:function(e){return{type:"SET_FUTURE_ACTION",futureAction:e}},setFutureActionDate:function(e){return{type:"SET_FUTURE_ACTION_DATE",futureActionDate:e}},setFutureActionEnabled:function(e){return{type:"SET_FUTURE_ACTION_ENABLED",futureActionEnabled:e}},setFutureActionTerms:function(e){return{type:"SET_FUTURE_ACTION_TERMS",futureActionTerms:e}},setFutureActionTaxonomy:function(e){return{type:"SET_FUTURE_ACTION_TAXONOMY",futureActionTaxonomy:e}},setTermsListByName:function(e){return{type:"SET_TERMS_LIST_BY_NAME",termsListByName:e}},setTermsListById:function(e){return{type:"SET_TERMS_LIST_BY_ID",termsListById:e}},setTaxonomyName:function(e){return{type:"SET_TAXONOMY_NAME",taxonomyName:e}},setIsFetchingTerms:function(e){return{type:"SET_IS_FETCHING_TERMS",isFetchingTerms:e}}},selectors:{getFutureAction:function(e){return e.futureAction},getFutureActionDate:function(e){return e.futureActionDate},getFutureActionEnabled:function(e){return e.futureActionEnabled},getFutureActionTerms:function(e){return e.futureActionTerms},getFutureActionTaxonomy:function(e){return e.futureActionTaxonomy},getTermsListByName:function(e){return e.termsListByName},getTermsListById:function(e){return e.termsListById},getTaxonomyName:function(e){return e.taxonomyName},getIsFetchingTerms:function(e){return e.isFetchingTerms}}});N(O),o("publishpress-future-action",{render:function(){var t=x((function(e){return e("publishpress-future/store").getFutureAction()}),[]),n=x((function(e){return e("publishpress-future/store").getFutureActionDate()}),[]),u=x((function(e){return e("publishpress-future/store").getFutureActionEnabled()}),[]),o=x((function(e){return e("publishpress-future/store").getFutureActionTerms()}),[]),s=x((function(e){return e("publishpress-future/store").getFutureActionTaxonomy()}),[]),d=x((function(e){return e("publishpress-future/store").getTermsListByName()}),[]),b=x((function(e){return e("publishpress-future/store").getTermsListById()}),[]),N=x((function(e){return e("publishpress-future/store").getIsFetchingTerms()}),[]),S=F("publishpress-future/store"),O=S.setFutureAction,B=S.setFutureActionDate,L=S.setFutureActionEnabled,C=S.setFutureActionTerms,w=S.setFutureActionTaxonomy,U=S.setTermsListByName,M=S.setTermsListById,P=S.setTaxonomyName,k=S.setIsFetchingTerms,Y=F("core/editor").editPost,j=function(e){L(e);var t={enabled:e};e&&(O(D.futureAction),B(D.futureActionDate),C(D.futureActionTerms),w(D.futureActionTaxonomy),t.action=D.futureAction,t.date=D.futureActionDate,t.terms=D.futureActionTerms,t.taxonomy=D.futureActionTaxonomy,X()),H(t)},X=function(){R("fetchTerms","Fetching terms...");var e=v("publishpress-future/store").getFutureActionTaxonomy(),t=v("core/editor").getCurrentPostType(),n={},u={};k(!0),R("futureActionTaxonomy",e),!e&&"post"===t||"category"===e?(R("fetchTerms","Fetching categories..."),I({path:h("wp/v2/categories",{per_page:-1})}).then((function(e){R("list",e),e.forEach((function(e){n[e.name]=e,u[e.id]=e.name})),U(n),M(u),P(r.strings.category),k(!1)}))):(R("fetchTerms","Fetching taxonomies..."),I({path:h("publishpress-future/v1/taxonomies/"+t)}).then((function(t){R("taxonomies",t.taxonomies),t.taxonomies.length>0?I({path:h("wp/v2/taxonomies/"+e,{context:"edit",per_page:-1})}).then((function(e){R("taxAttributes",e),I({path:h("wp/v2/"+e.rest_base,{context:"edit",per_page:-1})}).then((function(t){R("terms",t),t.forEach((function(e){n[A(e.name)]=e,u[e.id]=A(e.name)})),U(n),M(u),P(A(e.name)),k(!1)}))})):R("fetchTerms","No taxonomies found")})))},H=function(r){var i={publishpress_future_action:{enabled:u,date:n,action:t,terms:o,taxonomy:s}},a=!0,c=!1,f=void 0;try{for(var l,m=Object.entries(r)[Symbol.iterator]();!(a=(l=m.next()).done);a=!0){var T=l.value,p=e(T,2),A=p[0],d=p[1];i.publishpress_future_action[A]=d}}catch(e){c=!0,f=e}finally{try{!a&&m.return&&m.return()}finally{if(c)throw f}}Y(i),R("editPostAttribute",r,i)};_((function(){var e;e=v("core/editor").getEditedPostAttribute("publishpress_future_action"),L(e.enabled).then(undefined),O(e.action),B(e.date),C(e.terms),w(e.taxonomy);var t=v("publishpress-future/store").getFutureActionEnabled(),n=v("core/editor").isCleanNewPost();R("enabled",t),R("isCleanNewPost",n),t&&(n&&j(!0),X())}),[]);var G=[];return R("futureActionTerms",o),o&&o.length>0&&b&&"string"==typeof(G=g(o.map((function(e){return b[e]}))))&&(G=[]),React.createElement(i,{title:r.strings.postExpirator,icon:"calendar",initialOpen:u,className:"post-expirator-panel"},React.createElement(a,null,React.createElement(f,{label:r.strings.enablePostExpiration,checked:u,onChange:j})),u&&React.createElement(p,null,React.createElement(a,null,React.createElement(c,{currentDate:1e3*n,onChange:function(e){var t=new Date(e).getTime()/1e3;B(t),H({date:t})},__nextRemoveHelpButton:!0,is12Hour:r.is_12_hours,startOfWeek:r.start_of_week})),React.createElement(l,{label:r.strings.howToExpire,value:t,options:r.actions_options,onChange:function(e){O(e),H({action:e})}}),String(t).includes("category")&&(N&&React.createElement(p,null,r.strings.loading+" ("+s+")",React.createElement(T,null))||y(E(d))&&React.createElement("p",null,React.createElement("i",{className:"dashicons dashicons-warning"})," ",r.strings.noTermsFound)||React.createElement(m,{label:r.strings.expirationCategories+" ("+s+")",value:G,suggestions:Object.keys(d),onChange:function(e){e=e.map((function(e){return d[e].id})),C(e),H({terms:e})},maxSuggestions:10}))))}})}(window.wp,window.postExpiratorPanelConfig)})();
//# sourceMappingURL=gutenberg-panel.js.map